<main class="monitor-main">
  <div class="monitor-container">
    <!-- Header -->
    <div class="monitor-header">
      <div>
        <h2 class="monitor-title">{{ header.title }}</h2>
        <p class="monitor-subtitle">{{ header.subtitle }}</p>
      </div>

      <div class="monitor-header-actions">
        <select class="select" [(ngModel)]="selectedCampaign">
          @for (c of campaigns; track $index) {
            <option [value]="c.value">
              {{ c.label }}
            </option>
          }
        </select>

        <button class="btn-primary">
          <span class="btn-icon">
            <lucide-icon [name]="header.refreshIcon"></lucide-icon>
          </span>
          <span>{{ header.refreshLabel }}</span>
        </button>
      </div>
    </div>

    <!-- Metric cards -->
    <div class="metric-grid">
      @for (m of metricCards; track $index) {
        <div class="metric-card">
          <div class="metric-header">
            <p class="metric-label">{{ m.label }}</p>
            <lucide-icon [name]="m.icon" class="metric-icon"></lucide-icon>
          </div>
          <div class="metric-value">{{ m.value }}</div>
          <div class="metric-delta-row">
            <lucide-icon
              [name]="m.deltaIcon"
              [ngClass]="m.deltaColor === 'green' ? 'delta-icon--green' : 'delta-icon--red'"
            ></lucide-icon>
            <span [ngClass]="metricDeltaClass(m)">{{ m.deltaText }}</span>
            <span class="metric-delta-suffix">{{ m.deltaSuffix }}</span>
          </div>
        </div>
      }
    </div>

    <!-- Middle grid -->
    <div class="middle-grid">
      <!-- Provider status -->
      <div class="panel">
        <h3 class="panel-title">Provider Status</h3>
        <div class="provider-list">
          @for (p of providers; track $index) {
            <div class="provider-card">
              <div class="provider-header">
                <div class="provider-header-left">
                  <h4 class="provider-name">{{ p.name }}</h4>
                  <span [ngClass]="providerBadgeClass(p)">
                    <lucide-icon
                      [name]="p.badgeIcon"
                      class="provider-badge-icon"
                    ></lucide-icon>
                    <span>{{ p.badgeLabel }}</span>
                  </span>
                </div>
                <div class="provider-sessions">{{ p.sessions }}</div>
              </div>

              <div class="provider-metrics">
                <div class="provider-metric">
                  <p class="metric-label-small">Completes</p>
                  <p class="metric-value-small">{{ p.completes }}</p>
                </div>
                <div class="provider-metric">
                  <p class="metric-label-small">Quality</p>
                  <p class="metric-value-small">{{ p.quality }}</p>
                </div>
                <div class="provider-metric">
                  <p class="metric-label-small">Issue Rate</p>
                  <p class="metric-value-small">{{ p.issueRate }}</p>
                </div>
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Recent events -->
      <div class="panel">
        <h3 class="panel-title">Recent Events</h3>
        <div class="events-list">
          @for (e of events; track $index) {
            <div class="event-item">
              <div [ngClass]="eventDotClass(e)"></div>
              <div class="event-body">
                <p class="event-text">{{ e.text }}</p>
                <p class="event-time">{{ e.time }}</p>
              </div>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Respondent flow -->
    <div class="panel panel-flow">
      <h3 class="panel-title">Respondent Flow (Last Hour)</h3>

      <div class="flow-row">
        @for (step of flowSteps; track $index; let last = $last) {
          <ng-container>
            <div class="flow-step">
              <div class="flow-value" [ngClass]="step.colorClass">
                {{ step.value }}
              </div>
              <div class="flow-label">{{ step.label }}</div>
            </div>
            @if (!last) {
              <div class="flow-arrow">â†’</div>
            }
          </ng-container>
        }
      </div>

      <div class="flow-summary">
        <p class="flow-summary-text">
          <span class="flow-summary-strong">Completion Rate:</span>
          {{ completionRate }}
          |
          <span class="flow-summary-strong">Quality Rate:</span>
          {{ qualityRate }}
        </p>
      </div>
    </div>
  </div>
</main>